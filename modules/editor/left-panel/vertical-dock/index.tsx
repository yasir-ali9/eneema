import React from 'react';
import { ToolMode } from '../../core/types.ts';
import { Undo2, Redo2 } from 'lucide-react';
import { Button } from '../../../../components/button/default.tsx';
import { Tooltip } from '../../../../components/tooltip.tsx';

interface VerticalDockProps {
  toolMode: ToolMode;
  onSetToolMode: (mode: ToolMode) => void;
  onUndo: () => void;
  onRedo: () => void;
  canUndo: boolean;
  canRedo: boolean;
  zoom: number; // Single line comment: Zoom level passed from the core viewport state.
}

/**
 * Move Tool Icon Component
 * Single line comment: Precision cursor SVG exactly as provided, using currentColor for theme reactivity.
 */
const MoveToolIcon = () => (
  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M18.2186 6.67141L2.61434 1.57998C2.47035 1.53295 2.31603 1.52746 2.16906 1.56414C2.0221 1.60083 1.88846 1.67819 1.78346 1.78736C1.67846 1.89654 1.60637 2.0331 1.57544 2.18138C1.54452 2.32966 1.55602 2.48365 1.60862 2.62569L7.38005 18.2428C7.41576 18.3411 7.4814 18.4258 7.56774 18.4848C7.65407 18.5439 7.75674 18.5744 7.86131 18.572C7.96588 18.5696 8.06707 18.5345 8.15064 18.4716C8.23421 18.4087 8.29596 18.3212 8.32719 18.2214L10.5129 11.35C10.5763 11.1505 10.6827 10.9674 10.8246 10.8136C10.9666 10.6598 11.1406 10.5391 11.3343 10.46L18.2558 7.62855C18.3528 7.58892 18.4353 7.52042 18.4922 7.43233C18.549 7.34424 18.5774 7.24082 18.5735 7.13606C18.5696 7.03131 18.5336 6.93028 18.4704 6.84666C18.4072 6.76303 18.3198 6.70086 18.22 6.66855" stroke="currentColor" stroke-width="1.1" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
);

/**
 * Hand Tool Icon Component
 * Single line comment: Custom hand SVG for the panning tool.
 */
const HandToolIcon = () => (
  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M14.8833 4.64167C14.8888 4.42401 14.9472 4.21097 15.0535 4.02092C15.1597 3.83088 15.3106 3.66954 15.4931 3.55084C15.6756 3.43214 15.8843 3.35964 16.1011 3.33961C16.3179 3.31957 16.5363 3.3526 16.7375 3.43583C16.9819 3.53757 17.1904 3.70975 17.3366 3.93043C17.4828 4.15111 17.56 4.4103 17.5583 4.675V14.8C17.5599 15.4002 17.4429 15.9948 17.2141 16.5496C16.9853 17.1045 16.6492 17.6087 16.225 18.0333C15.3672 18.8907 14.2045 19.3732 12.9917 19.375H10.3833C9.50131 19.376 8.63273 19.159 7.85489 18.7431C7.07705 18.3273 6.41408 17.7257 5.92499 16.9917L2.66665 12.1C2.56562 11.9479 2.49587 11.7773 2.46149 11.598C2.42711 11.4187 2.42878 11.2343 2.4664 11.0557C2.50402 10.877 2.57685 10.7077 2.68062 10.5575C2.78439 10.4073 2.91704 10.2792 3.07082 10.1808C3.3126 10.0271 3.59638 9.95271 3.88249 9.9681C4.1686 9.98349 4.44276 10.0879 4.66665 10.2667L6.84999 12.0083V3.33333C6.84999 2.97971 6.99046 2.64057 7.24051 2.39052C7.49056 2.14048 7.8297 2 8.18332 2C8.53771 1.99999 8.87772 2.1402 9.12909 2.39001C9.38046 2.63983 9.52279 2.97895 9.52499 3.33333V1.96667C9.52488 1.61654 9.66165 1.28023 9.9061 1.02956C10.1505 0.778884 10.4833 0.633699 10.8333 0.625C11.1892 0.625 11.5304 0.766354 11.782 1.01797C12.0336 1.26958 12.175 1.61083 12.175 1.96667V3.33333C12.175 2.97971 12.3155 2.64057 12.5655 2.39052C12.8156 2.14048 13.1547 2 13.5083 2C13.6866 1.99557 13.864 2.02672 14.0301 2.09163C14.1962 2.15655 14.3477 2.25392 14.4757 2.37807C14.6037 2.50221 14.7057 2.65063 14.7757 2.81466C14.8457 2.97868 14.8823 3.15501 14.8833 3.33333V4.64167ZM14.8833 4.64167V8.65833M9.52499 3.3V8.65833M12.2083 3.3V8.65833" stroke="currentColor" stroke-width="1.1" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
);

/**
 * Lasso Tool Icon Component
 * Single line comment: Complex Lasso SVG exactly as provided, using currentColor for dynamic highlighting.
 */
const LassoToolIcon = () => (
  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M8.0858 1.88746C8.71317 1.74009 9.35552 1.66598 9.99996 1.66663C10.6583 1.66663 11.2991 1.7433 11.9141 1.88746C11.9953 1.90497 12.0722 1.93848 12.1402 1.98604C12.2083 2.03359 12.2662 2.09423 12.3106 2.16441C12.355 2.2346 12.3849 2.31293 12.3987 2.39481C12.4124 2.4767 12.4098 2.56051 12.3908 2.64135C12.3718 2.72219 12.3369 2.79843 12.2881 2.86562C12.2393 2.93281 12.1776 2.98961 12.1066 3.0327C12.0356 3.07578 11.9568 3.10429 11.8746 3.11655C11.7925 3.12882 11.7088 3.12459 11.6283 3.10413C11.0946 2.97883 10.5482 2.91591 9.99996 2.91663C9.4518 2.91665 8.90545 2.97956 8.37163 3.10413C8.29115 3.12459 8.20741 3.12459 8.12528 3.11655C8.04315 3.10429 7.9643 3.07578 7.89331 3.0327C7.82233 2.98961 7.76064 2.93281 7.71185 2.86562C7.66306 2.79843 7.62815 2.72219 7.60916 2.64135C7.59017 2.56051 7.58748 2.4767 7.60124 2.39481C7.61501 2.31293 7.64495 2.2346 7.68932 2.16441C7.7337 2.09423 7.79161 2.03359 7.85969 1.98604C7.92776 1.93848 8.00463 1.90497 8.0858 1.88746ZM6.47746 3.11246C6.52077 3.18222 6.54991 3.25983 6.56321 3.34085C6.57651 3.42187 6.57372 3.50472 6.55499 3.58466C6.53626 3.66461 6.50196 3.74007 6.45406 3.80676C6.40615 3.87344 6.34558 3.93003 6.2758 3.9733C5.34086 4.55278 4.55278 5.34086 3.9733 6.2758C3.93054 6.34654 3.87418 6.40809 3.80747 6.4569C3.74076 6.50571 3.66503 6.5408 3.58467 6.56015C3.50431 6.57949 3.42091 6.5827 3.3393 6.5696C3.25768 6.55649 3.17948 6.52732 3.10922 6.48379C3.03896 6.44025 2.97803 6.38321 2.92996 6.31597C2.88189 6.24872 2.84764 6.17261 2.82918 6.09204C2.81073 6.01147 2.80844 5.92804 2.82245 5.84658C2.83646 5.76512 2.86649 5.68724 2.9108 5.61746C3.59198 4.51839 4.51839 3.59198 5.61746 2.9108C5.75838 2.82368 5.92812 2.79607 6.08938 2.83404C6.25064 2.87201 6.39023 2.97245 6.47746 3.1133M13.5225 3.1133C13.6098 2.97259 13.7495 2.87232 13.9107 2.83451C14.072 2.7967 14.2417 2.82443 14.3825 2.91163C15.4815 3.59281 16.408 4.51923 17.0891 5.6183C17.1334 5.68807 17.1635 5.76595 17.1775 5.84741C17.1915 5.92887 17.1892 6.0123 17.1707 6.09288C17.1523 6.17345 17.118 6.24956 17.07 6.3168C17.0219 6.38404 16.961 6.44108 16.8907 6.48462C16.8204 6.52816 16.7422 6.55732 16.6606 6.57043C16.579 6.58354 16.4956 6.58033 16.4153 6.56098C16.3349 6.54164 16.2592 6.50655 16.1925 6.45774C16.1258 6.40893 16.0694 6.34737 16.0266 6.27663C15.4472 5.34169 14.6591 4.55361 13.7241 3.97413C13.5834 3.88676 13.4832 3.74711 13.4453 3.58586C13.4075 3.42461 13.4353 3.25411 13.5225 3.1133ZM2.63913 7.62246C2.80029 7.66049 2.93977 7.76091 3.02695 7.90169C3.11414 8.04246 3.14189 8.21208 3.10413 8.3733C2.97896 8.90645 2.91604 9.45232 2.91663 9.99996C2.91663 10.5608 2.98163 11.1058 3.10413 11.6283C3.12459 11.7088 3.12882 11.7925 3.11655 11.8746C3.10429 11.9568 3.07578 12.0356 3.0327 12.1066C2.98961 12.1776 2.93281 12.2393 2.86562 12.2881C2.79843 12.3369 2.72219 12.3718 2.64135 12.3908C2.56051 12.4098 2.4767 12.4124 2.39481 12.3987C2.31293 12.3849 2.2346 12.355 2.16441 12.3106C2.09423 12.2662 2.03359 12.2083 1.98604 12.1402C1.93848 12.0722 1.90497 11.9953 1.88746 11.9141C1.74009 11.2868 1.66598 10.6444 1.66663 9.99996C1.66663 9.34163 1.7433 8.7008 1.88746 8.0858C1.9062 8.00584 1.9405 7.93035 1.98843 7.86365C2.03635 7.79696 2.09695 7.74036 2.16675 7.6971C2.23656 7.65384 2.31421 7.62476 2.39527 7.61152C2.47632 7.59829 2.55919 7.60115 2.63913 7.61996M17.3608 7.61996C17.5221 7.58195 17.692 7.60959 17.8329 7.69679C17.9739 7.784 18.0744 7.92362 18.1125 8.08496C18.4067 9.3444 18.4067 10.6547 18.1125 11.9141C18.095 11.9953 18.0614 12.0722 18.0139 12.1402C17.9663 12.2083 17.9057 12.2662 17.8355 12.3106C17.7653 12.355 17.687 12.3849 17.6051 12.3987C17.5232 12.4124 17.4394 12.4098 17.3586 12.3908C17.2777 12.3718 17.2015 12.3369 17.1343 12.2881C17.0671 12.2393 17.0103 12.1776 16.8958 11.6283C17.1472 10.5573 17.147 9.44253 16.895 8.37163C16.8762 8.29169 16.8733 8.20882 16.8865 8.12777C16.8998 8.04671 16.9288 7.96906 16.9288 7.89925C17.0154 7.82945 17.072 7.76885 17.1387 7.72093C17.2053 7.673 17.2808 7.6387 17.3608 7.61996ZM3.1133 13.5216C3.25411 13.4344 3.42378 13.4067 3.58503 13.4445C3.74628 13.4823 3.88593 13.5826 3.9733 13.7233C4.55278 14.6582 5.34086 15.4463 6.2758 16.0258C6.41472 16.114 6.51324 16.2535 6.54998 16.4139C6.58672 16.5743 6.55872 16.7427 6.47204 16.8826C6.38536 17.0225 6.24702 17.1225 6.08702 17.1611C5.92703 17.1996 5.7583 17.1734 5.61746 17.0883C4.51839 16.4071 3.59198 15.4807 2.9108 14.3816C2.82368 14.2407 2.79607 14.071 2.83404 13.9097C2.87201 13.7485 2.97245 13.6089 3.1133 13.5216ZM17.0175 14.2366C17.0549 14.1631 17.0774 14.0829 17.0837 14.0007C17.0899 13.9184 17.0799 13.8358 17.054 13.7574C17.0282 13.6791 16.9871 13.6066 16.9332 13.5443C16.8792 13.4819 16.8134 13.4308 16.7396 13.3939C16.6658 13.3571 16.5855 13.3352 16.5032 13.3296C16.4209 13.3239 16.3383 13.3346 16.2602 13.3611C16.182 13.3875 16.1099 13.4292 16.0479 13.4836C15.986 13.538 15.9354 13.6042 15.8991 13.6783L15.8975 13.6816L15.885 13.7058L15.8275 13.8083C15.7516 13.9405 15.6713 14.07 15.5866 14.1966C15.3465 14.5564 15.0775 14.8962 14.7825 15.2125C13.8075 14.3183 12.4858 13.5408 10.8325 13.5408C8.87663 13.5408 7.50746 14.5433 7.50746 15.9366C7.50746 17.33 8.87746 18.3333 10.8333 18.3333C12.4516 18.3333 13.7458 17.7083 14.715 16.9625C15.1367 17.4817 15.504 18.043 15.8108 18.6375C15.8386 18.6925 15.8589 18.7339 15.8716 18.7616L15.8858 18.7908L15.8891 18.7983C15.9584 18.9474 16.0837 19.0632 16.2377 19.1206C16.3918 19.178 16.5622 19.1724 16.7122 19.105C16.8622 19.0376 16.9795 18.9138 17.0388 18.7604C17.0981 18.6071 17.0947 18.4366 17.0291 18.2858C16.9566 18.1333 17.0291 18.285 17.0291 18.285V18.2833L17.0266 18.28L17.0208 18.2675L17.0008 18.2241L16.925 18.0708C16.5679 17.3781 16.1383 16.7252 15.6433 16.1233C16.1309 15.6098 16.5573 15.0416 16.9141 14.43L16.9891 14.295L17.0091 14.2558L17.015 14.2441L17.0166 14.24L17.0175 14.2366ZM10.8333 14.7916C12.0275 14.7916 13.0366 15.335 13.8466 16.0516C13.055 16.635 12.0508 17.0833 10.8333 17.0833C9.18913 17.0833 8.7583 16.315 8.7583 15.9375C8.7583 15.56 9.18913 14.7916 10.8333 14.7916Z" fill="currentColor"/>
  </svg>
);

/**
 * Brush Tool Icon Component
 * Single line comment: High-precision custom Brush SVG with refined stroke.
 */
const BrushToolIcon = () => (
  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2.90086 14.5176H17.0991M2.90086 14.5176V17.0991C2.90086 17.4415 3.03685 17.7698 3.27891 18.0118C3.52098 18.2539 3.84928 18.3899 4.19161 18.3899H15.8084C16.1507 18.3899 16.479 18.2539 16.7211 18.0118C16.9631 17.7698 17.0991 17.4415 17.0991 17.0991V14.5176M2.90086 14.5176C2.55853 14.5176 2.23022 14.3816 1.98816 14.1396C1.7461 13.8975 1.61011 13.5692 1.61011 13.2269V11.9361C1.61011 11.2515 1.88209 10.5949 2.36621 10.1107C2.85034 9.6266 3.50696 9.35462 4.19161 9.35462H5.48237C5.82469 9.35462 6.153 9.21863 6.39507 8.97657C6.63713 8.73451 6.77312 8.4062 6.77312 8.06387V4.83699C6.77312 3.98117 7.11309 3.1604 7.71825 2.55524C8.32341 1.95008 9.14418 1.61011 10 1.61011C10.8558 1.61011 11.6766 1.95008 12.2818 2.55524C12.8869 3.1604 13.2269 3.98117 13.2269 4.83699V8.06387C13.2269 8.4062 13.3629 8.73451 13.6049 8.97657C13.847 9.21863 14.1753 9.35462 14.5176 9.35462H15.8084C16.493 9.35462 17.1497 9.6266 17.6338 10.1107C18.1179 10.5949 18.3899 11.2515 18.3899 11.9361V13.2269C18.3899 13.5692 18.2539 13.8975 18.0118 14.1396C17.7698 14.3816 17.4415 14.5176 17.0991 14.5176" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
);

/**
 * VerticalDock Component
 * Persistent sidebar for core tools and history, providing a stable target for common actions.
 */
const VerticalDock: React.FC<VerticalDockProps> = ({ 
  toolMode, onSetToolMode, onUndo, onRedo, canUndo, canRedo, zoom 
}) => {
  return (
    <div className="w-12 h-full bg-bk-50 border-r border-bd-50 flex flex-col items-center py-4 justify-between z-30">
      
      {/* Primary Tool Selection Group (Top) */}
      <div className="flex flex-col items-center gap-2">
        <Tooltip content="Move Tool (V)" position="right" offset={10}>
          <Button 
            variant={toolMode === ToolMode.SELECT ? 'primary' : 'ghost'} 
            size="icon" 
            className={`w-9 h-9 transition-colors ${toolMode !== ToolMode.SELECT ? 'hover:!bg-bk-40' : ''}`}
            onClick={() => onSetToolMode(ToolMode.SELECT)}
          >
            <MoveToolIcon />
          </Button>
        </Tooltip>

        <Tooltip content="Hand Tool (H)" position="right" offset={10}>
          <Button 
            variant={toolMode === ToolMode.PAN ? 'primary' : 'ghost'} 
            size="icon" 
            className={`w-9 h-9 transition-colors ${toolMode !== ToolMode.PAN ? 'hover:!bg-bk-40' : ''}`}
            onClick={() => onSetToolMode(ToolMode.PAN)}
          >
            <HandToolIcon />
          </Button>
        </Tooltip>

        {/* Divider between Move/Hand and Selection tools */}
        <div className="w-6 h-[1px] bg-bd-50 my-1" />

        <Tooltip content="Lasso Tool (L)" position="right" offset={10}>
          <Button 
            variant={toolMode === ToolMode.LASSO ? 'primary' : 'ghost'} 
            size="icon" 
            className={`w-9 h-9 transition-colors ${toolMode !== ToolMode.LASSO ? 'hover:!bg-bk-40' : ''}`}
            onClick={() => onSetToolMode(ToolMode.LASSO)}
          >
            <LassoToolIcon />
          </Button>
        </Tooltip>

        <Tooltip content="Brush Tool (B)" position="right" offset={10}>
          <Button 
            variant={toolMode === ToolMode.BRUSH ? 'primary' : 'ghost'} 
            size="icon" 
            className={`w-9 h-9 transition-colors ${toolMode !== ToolMode.BRUSH ? 'hover:!bg-bk-40' : ''}`}
            onClick={() => onSetToolMode(ToolMode.BRUSH)}
          >
            <BrushToolIcon />
          </Button>
        </Tooltip>
      </div>

      {/* Navigation and Zoom Info (Bottom) */}
      <div className="flex flex-col items-center gap-2">
        {/* History Navigation Group */}
        <div className="flex flex-col gap-2">
          <Tooltip content="Undo (Ctrl+Z)" position="right" offset={10}>
            <Button 
              variant="ghost" 
              size="icon" 
              className="w-9 h-9 transition-colors hover:!bg-bk-40"
              onClick={onUndo}
              disabled={!canUndo}
            >
              <Undo2 size={16} />
            </Button>
          </Tooltip>

          <Tooltip content="Redo (Ctrl+Y)" position="right" offset={10}>
            <Button 
              variant="ghost" 
              size="icon" 
              className="w-9 h-9 transition-colors hover:!bg-bk-40"
              onClick={onRedo}
              disabled={!canRedo}
            >
              <Redo2 size={16} />
            </Button>
          </Tooltip>
        </div>

        {/* Divider above zoom level */}
        <div className="w-6 h-[1px] bg-bd-50 my-1" />

        {/* Zoom Level Indicator - Styled to match UI icons without borders and in Inter font */}
        <div className="text-[10px] font-sans text-fg-60 px-1 py-1 select-none">
          {Math.round(zoom * 100)}%
        </div>
      </div>
    </div>
  );
};

export default VerticalDock;